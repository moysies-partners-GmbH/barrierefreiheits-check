<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="main.css" />
    <title>Intrexx barrierefreiheits-checks by moysies & partners GmbH</title>
  </head>

  <body>
    <div class="bookmarklet-wrap">
      <a id="bookmarklet" class="bookmarklet">barrierefreiheits-check</a>
      <div>Drop me into your bookmarks</div>
    </div>
    <div class="links">
      <a href="errors.html">ERRORS</a>
      <a href="noErrors.html">NOERRORS</a>
    </div>
  </body>

  <script>
    const id = "mp_accessibility";
    const local = "http://127.0.0.1:5500";
    const online =
      "https://moysies-partners-gmbh.github.io/barrierefreiheits-check";

    const code = `
     let currentUrl = window.location.origin;
     const isLocalhost = currentUrl.includes("127.0.0.1") || currentUrl.includes("localhost");
     const currenUrl = (isLocalhost ? "${local}":"${online}") + "/main.js";
     const scriptElement = document.querySelector('#${id}');
     const script = document.createElement('script');
     script.id = '${id}';
     const usn = new Date().getTime()
     const url = currenUrl+'?usn='+ usn
     if(!scriptElement){
       script.onload = ()=>{
         window.runMpAccessibility()
       }
      document.body.appendChild(script).src=url
      return 
     }
      window.runMpAccessibility()
    `;
    const output =
      "javascript:" + encodeURIComponent("(function(){" + code + "})();");

    document.querySelector("#bookmarklet").href = output;
  </script>
</html>
